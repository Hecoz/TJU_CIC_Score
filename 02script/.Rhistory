}
}
write.xlsx(newStuData, paste("../03output/01-学生成绩(删除智能科学及2019级数据)",".xls",sep = ""))
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "07-智算学生成绩最终版(合并04和06).xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
}
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/02-最终成绩",".xls",sep = ""),row.names = FALSE)
#从02-学生成绩(删除智能科学).xls中删除2019级新生数据，用2019级新数据替换
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../01input", "02-学生成绩(删除智能科学).xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuClass <-  unique(allStuData[,c("学生类别")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(!(startsWith(stuNum,"2019") || startsWith(stuNum,"2119") || startsWith(stuNum,"6219"))){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../01input/06-学生成绩(删除智能科学及2019级数据)",".xls",sep = ""))
#从02-学生成绩(删除智能科学).xls中删除2019级新生数据，用2019级新数据替换
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../01input", "02-学生成绩(删除智能科学).xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(!(startsWith(stuNum,"2019") || startsWith(stuNum,"2119") || startsWith(stuNum,"6219"))){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../01input/06-学生成绩(删除智能科学及2019级数据)",".xls",sep = ""))
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "07-智算学生成绩最终版(合并04和06).xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
}
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/01-最终成绩",".xls",sep = ""),row.names = FALSE)
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "07-智算学生成绩最终版(合并04和06).xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
}
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/01-最终成绩",".xls",sep = ""),row.names = FALSE,sheetName = "Sheet0")
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"2018") || startsWith(stuNum,"1018216001")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/最终成绩_硕2018",".xls",sep = ""))
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "01-原始学生成绩.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
}
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/01-最终成绩2017",".xls",sep = ""),row.names = FALSE,sheetName = "Sheet0")
#从02-学生成绩(删除智能科学).xls中删除2019级新生数据，用2019级新数据替换
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2017.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"1017")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/03-学生成绩1017",".xls",sep = ""))
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "07-智算学生成绩最终版(合并04和06) copy.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
}
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/01-最终成绩2019",".xls",sep = ""),row.names = FALSE,sheetName = "Sheet0")
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2019.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"2019") || startsWith(stuNum,"2119")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/04-最终成绩_硕2019",".xls",sep = ""))
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"2019") || startsWith(stuNum,"2119")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/05-最终成绩_硕2019",".xls",sep = ""))
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "07-智算学生成绩最终版(合并04和06) copy.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
}
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/01-最终成绩2019",".xls",sep = ""),row.names = FALSE,sheetName = "Sheet0")
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2019.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"2019") || startsWith(stuNum,"2119")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/04-最终成绩_硕2019",".xls",sep = ""))
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2019.xls", "Sheet0")
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2019.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"2019") || startsWith(stuNum,"2119")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/04-最终成绩_硕2019",".xls",sep = ""))
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2019.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2019.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
View(allStuData)
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩2019.xls", "Sheet0")
#allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"2019") || startsWith(stuNum,"2119")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/04-最终成绩_硕2019",".xls",sep = ""))
#提取对应年纪所有成绩
library(readxl)
library(xlsx)
source("utils.R")
#读取所有人数据
allStuData <- readData("../03output", "01-最终成绩.xls", "Sheet0")
#allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
if(startsWith(stuNum,"2019") || startsWith(stuNum,"2119")){
print(stuNum)
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
newStuData <- rbind(newStuData, currentStu)
}
}
write.xlsx(newStuData, paste("../03output/05-最终成绩_硕2019",".xls",sep = ""))
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "2021全体成绩.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
View(newStuData)
View(newStuData)
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
View(allMasterStuNum)
classesInfo <- computeClassesInfo(newStuData)
View(classesInfo)
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "2021全体成绩.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
#  if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
#  }
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/最终成绩2021",".xls",sep = ""),row.names = FALSE,sheetName = "Sheet0")
#学业奖计算程序
#作者：zyq
#最后修改时间：
library(readxl)
library(xlsx)
source("utils.R")
#main
allStuData <- readData("../01input", "2022学生成绩/2022全体成绩.xls", "Sheet0")
allStuData <- dataProcessing(allStuData)
allStuNum <-  unique(allStuData[,c("学号")])
newStuData <- NULL
for (stuNum in allStuNum$学号) {
currentStu <- allStuData[which(allStuData$学号 == stuNum),]
currentStu <- recalcScoreAndRemoveDupFailedClasses(currentStu)
currentStu <- removeFailedClasses(currentStu)
if(nrow(currentStu) > 0){
newStuData <- rbind(newStuData, currentStu)
}
}
masters <- getDataByStuType(newStuData, c("博士生","同等学力博","工程博士","留学博士","硕士生","双证工程硕","工程硕士","留学硕士"))
allMasterStuNum <- unique(masters[,c("学号")])
allAllowStuData <- readData("../01input","05-奖学金发放对象.xlsx", "Sheet0")
allAllowStuNum <-  unique(allAllowStuData[,c("学号")])
classesInfo <- computeClassesInfo(newStuData)
FinalScore <- NULL
for(stuNum in allMasterStuNum$学号){
#  if(stuNum %in% allAllowStuNum$学号){
currentStu <- masters[which(masters$学号 == stuNum),]
currentStuName <- currentStu$姓名[1]
print(paste(stuNum, currentStuName,sep = "-"))
stuInfo <- calcCurrentStuFinalScore(classesInfo, currentStu)
FinalScore <- rbind(FinalScore, stuInfo)
#  }
}
FinalScore <- data.frame(FinalScore)
colnames(FinalScore) <- c("学号","姓名", "院系", "专业", "修读类别", "学籍状态", "考试类别", "学生类别", "考试情况", "导师","总分")
write.xlsx(FinalScore, paste("../03output/最终成绩2022",".xls",sep = ""),row.names = FALSE,sheetName = "Sheet0")
